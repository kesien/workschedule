<ngx-spinner></ngx-spinner>
<div class="container">
  <div class="row">
    <div class="col-12">
      <h3>Kéréseim:</h3>
    </div>
  </div>
  <div class="justify-content-center mt-3">
    <table
      class="
        table table-striped table-hover table-bordered
        align-middle
        table-sm
      "
    >
      <thead class="table-dark text-center align-middle">
        <tr>
          <th>
            Év
            <select
              class="form-select-sm"
              (change)="filterRequests()"
              [(ngModel)]="filter.year"
              name="year"
            >
              <option *ngIf="years.length === 0">
                {{ date.getFullYear() }}
              </option>
              <option
                *ngFor="let year of years"
                [ngValue]="year"
                [selected]="date.getFullYear() === year"
              >
                {{ year }}
              </option>
            </select>
          </th>
          <th>
            Hónap
            <select
              class="form-select-sm"
              (change)="filterRequests()"
              [(ngModel)]="filter.month"
              name="month"
            >
              <option [ngValue]="0">Összes</option>
              <option
                *ngFor="let month of months"
                [ngValue]="months.indexOf(month) + 1"
              >
                {{ month }}
              </option>
            </select>
          </th>
          <th>Nap</th>
          <th>Típus</th>
          <th>&nbsp;</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let request of filteredRequests()">
          <td>{{ request.date | date: "yyyy" }}</td>
          <td>{{ request.date | date: "MM" }}</td>
          <td>{{ request.date | date: "dd" }}</td>
          <td>{{ getType(request.type) }}</td>
          <td>
            <a class="btn btn-danger" (click)="deleteRequest(request)">
              <i class="fa fa-trash"></i>
            </a>
          </td>
        </tr>
        <tr *ngIf="filteredRequests().length === 0">
          <td colspan="5">
            <h5 class="text-center m-4">Nincsenek kéréseid erre a hónapra.</h5>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
  <div class="row justify-content-center mt-5" *ngIf="!createMode">
    <div class="col-lg-4 col-md-6 col-12">
      <div class="d-grid gap-2">
        <button class="btn btn-success" (click)="cancel(true)">Új kérés</button>
      </div>
    </div>
  </div>
  <app-new-request
    *ngIf="createMode"
    [model]="model"
    (onCreateNewRequest)="createRequest()"
    (onCancel)="cancel($event)"
  ></app-new-request>
</div>